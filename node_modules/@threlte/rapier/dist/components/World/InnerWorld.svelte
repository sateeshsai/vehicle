<script
  context="module"
 
>import { onDestroy, setContext, tick } from 'svelte';
import { useFrameHandler } from '../../hooks/useFrameHandler';
import { createRapierContext } from '../../lib/createRapierContext';
</script>

<script>export let gravity = [0, -9.81, 0];
export let rawIntegrationParameters = undefined;
export let rawIslands = undefined;
export let rawBroadPhase = undefined;
export let rawNarrowPhase = undefined;
export let rawBodies = undefined;
export let rawColliders = undefined;
export let rawImpulseJoints = undefined;
export let rawMultibodyJoints = undefined;
export let rawCCDSolver = undefined;
export let rawQueryPipeline = undefined;
export let rawPhysicsPipeline = undefined;
export let rawSerializationPipeline = undefined;
export let rawDebugRenderPipeline = undefined;
export let order = undefined;
const rapierContext = createRapierContext({ x: gravity[0], y: gravity[1], z: gravity[2] }, rawIntegrationParameters, rawIslands, rawBroadPhase, rawNarrowPhase, rawBodies, rawColliders, rawImpulseJoints, rawMultibodyJoints, rawCCDSolver, rawQueryPipeline, rawPhysicsPipeline, rawSerializationPipeline, rawDebugRenderPipeline);
setContext('threlte-rapier-context', rapierContext);
$: if (gravity !== undefined) {
    rapierContext.world.gravity = { x: gravity[0], y: gravity[1], z: gravity[2] };
}
useFrameHandler(rapierContext, order);
onDestroy(async () => {
    await tick();
    rapierContext.world.free();
});
</script>

<slot />
