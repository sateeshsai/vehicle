import { getContext, onDestroy } from 'svelte';
import { browser } from '../lib/browser';
/**
 * Adds a handler that is called on every invalidated frame. This handler is
 * only called when an actual render should happen.
 * @param fn
 * @param options
 * @returns
 */
export const useRender = (fn, options) => {
    if (!browser) {
        return;
    }
    const renderCtx = getContext('threlte-internal-context');
    const handler = {
        fn,
        order: options?.order
    };
    renderCtx.renderHandlers.add(handler);
    onDestroy(() => {
        renderCtx.renderHandlers.delete(handler);
    });
};
